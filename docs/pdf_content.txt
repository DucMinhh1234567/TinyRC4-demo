Bรi giแบฃng 
AN TOรN Vร BแบขO MแบฌT THรNG TIN
Chฦฐฦกng 2: Mร HOร KHOร ฤแปI XแปจNG (Mร HOร KHOร Bร MแบฌT)
ฤแบI HแปC KINH Tแบพ QUแปC DรN
KHOA CรNG NGHแป THรNG TIN
ThS. Nguyแปn Quแปc Thรกi
1

MแปคC TIรU CHฦฏฦNG
ยก ๐ Kiแบฟn thแปฉc:
ยก Hiแปu khรกi niแปm: bแบฃn rรต, bแบฃn mรฃ, khรณa, mรฃ hรณa & giแบฃi mรฃ
ยก Trรฌnh bรy cรกc thuแบญt toรกn mรฃ hรณa ฤแปi xแปฉng cแป ฤiแปn & hiแปn ฤแบกi
ยก Nแบฏm tรญnh chแปฉng thแปฑc, tรญnh khรดng chแปi bแป vร cฦก chแบฟ KDC
ยก ๐ Kแปน nฤng:
ยก Phรขn tรญch, so sรกnh cรกc thuแบญt toรกn mรฃ hรณa ฤแปi xแปฉng
ยก Vแบญn dแปฅng thuแบญt toรกn ฤแป mรฃ hรณa/giแบฃi mรฃ dแปฏ liแปu ฤฦกn giแบฃn
ยก Nhแบญn diแปn tแบฅn cรดng thรกm mรฃ vร ฤแป xuแบฅt biแปn phรกp phรฒng chแปng
2

NแปI DUNG CHฦฏฦNG
1. Giแปi thiแปu chung
2. Mรฃ hoรก ฤแปi xแปฉng cแป ฤiแปn
3. Mรฃ hoรก ฤแปi xแปฉng hiแปn ฤแบกi
4. Tรญnh chแปฉng thแปฑc (authentication) vร tรญnh khรดng tแปซ chแปi (non-
repudiation)
5. Trao ฤแปi khoรก bรญ mแบญt bแบฑng trung tรขm phรขn phแปi khoรก (KDC)
3

1 โ GIแปI THIแปU CHUNG
ยก Cรกc khรกi niแปm cฦก bแบฃn
ยก Cรกc yรชu cแบงu ฤแป sแปญ dแปฅng an toรn hแป mรฃ hรณa
ยก ฤแบทc trฦฐng cแปงa hแป mรฃ hรณa
ยก Thรกm mรฃ
ยก ฤแป an toรn cแปงa hแป mรฃ hรณa
4

1 โ GIแปI THIแปU CHUNG
ยก Cรกc khรกi niแปm cฦก bแบฃn
ยก Khรกi niแปm: Mรฃ hรณa khรณa ฤแปi xแปฉng sแปญ dแปฅng cรนng mแปt khรณa cho viแปc mรฃ
hรณa vร giแบฃi mรฃ => Cรณ thแป nรณi mรฃ ฤแปi xแปฉng lร mรฃ mแปt khoรก (hay mรฃ
khรณa riรชng, mรฃ khoรก thแปa thuแบญn).
=> Bแบฃn chแบฅt: Ngฦฐแปi gแปญi vร ngฦฐแปi nhแบญn chia sแบป khoรก chung K, mร hแป
cรณ thแป trao ฤแปi bรญ mแบญt vแปi nhau. Ta xรฉt hai hรm ngฦฐแปฃc nhau: E lร hรm
biแบฟn ฤแปi bแบฃn rรต thรnh bแบฃn mรฃ vร D lร hรm biแบฟn ฤแปi bแบฃn mรฃ trแป vแป bแบฃn
rรต. Giแบฃ sแปญ gแปi X lร vฤn bแบฃn cแบงn mรฃ hรณa vร Y lร dแบกng vฤn bแบฃn ฤรฃ ฤฦฐแปฃc
thay ฤแปi qua viแปc mรฃ hรณa => Ta cรณ kรฝ hiแปu: Y = EK(X), X = DK(Y).
5

1 โ GIแปI THIแปU CHUNG
ยก Cรกc khรกi niแปm cฦก bแบฃn
6
Vฤn bแบฃn rรต (plaintext, clear text) lร 
bแบฅt kแปณ dแปฏ liแปu nรo cรณ thแป ฤแปc ฤฦฐแปฃc vร 
cแบงn ฤฦฐแปฃc bแบฃo vแป
Vฤn bแบฃn rรต cรณ thแป ฤฦฐแปฃc sแปญ dแปฅng mร 
khรดng cแบงn thuแบญt toรกn giแบฃi mรฃ
Vฤn bแบฃn mรฃ hoรก(ciphertext) lร kแบฟt 
quแบฃ sau khi mรฃ hoรก vฤn bแบฃn rรต sแปญ dแปฅng 
thuแบญt toรกn mรฃ hoรก
Vฤn bแบฃn mรฃ hoรก khรดng thแป ฤฦฐแปฃc sแปญ dแปฅng 
hoแบทc ฤแปc trแปฑc tiแบฟp โ cแบงn thuแบญt toรกn giแบฃi mรฃ
Vฤn bแบฃn rรต
Vฤn bแบฃn mรฃ hoรก

1 โ GIแปI THIแปU CHUNG
ยก Cรกc khรกi niแปm cฦก bแบฃn
ยก Bแบฃn rรต (plain text): X ฤฦฐแปฃc gแปi lร lร bแบฃn tin gแปc. Bแบฃn rรต cรณ thแป ฤฦฐแปฃc chia nhแป cรณ
kรญch thฦฐแปc phรน hแปฃp.
ยก Bแบฃn mรฃ (cipher text): Y lร bแบฃn tin gแปc ฤรฃ ฤฦฐแปฃc mรฃ hoรก. แป ฤรขy ta thฦฐแปng xรฉt
phฦฐฦกng phรกp mรฃ hรณa mร khรดng lรm thay ฤแปi kรญch thฦฐแปc cแปงa bแบฃn rรต, tแปฉc lร chรบng
cรณ cรนng ฤแป dรi.
ยก Mรฃ: lร thuแบญt toรกn E chuyแปn bแบฃn rรต thรnh bแบฃn mรฃ. Thรดng thฦฐแปng chรบng ta cแบงn
thuแบญt toรกn mรฃ hรณa mแบกnh, cho dรน kแบป thรน biแบฟt ฤฦฐแปฃc thuแบญt toรกn, nhฦฐng khรดng biแบฟt
thรดng tin vแป khรณa cลฉng khรดng tรฌm ฤฦฐแปฃc bแบฃn rรต.
ยก Khoรก (key): K lร thรดng tin tham sแป dรนng ฤแป mรฃ hoรก, chแป cรณ ngฦฐแปi gแปญi vร nguแปi
nhแบญn biแบฟt. Khรณa lร ฤแปc lแบญp vแปi bแบฃn rรต vร cรณ ฤแป dรi phรน hแปฃp vแปi yรชu cแบงu bแบฃo mแบญt.
ยก Mรฃ hoรก (encryption): lร quรก trรฌnh chuyแปn bแบฃn rรต thรnh bแบฃn mรฃ, thฦฐแปng gแปm viแปc
รกp dแปฅng thuแบญt toรกn mรฃ hรณa vร mแปt sแป quรก trรฌnh xแปญ lรฝ thรดng tin kรจm theo.
ยก Giแบฃi mรฃ (decryption): chuyแปn bแบฃn mรฃ => bแบฃn rรต,quรก trรฌnh ngฦฐแปฃc lแบกi cแปงa mรฃ hรณa.
7

1 โ GIแปI THIแปU CHUNG
ยก Cรกc khรกi niแปm cฦก bแบฃn
ยก Mรด hรฌnh mรฃ hoรก ฤแปi xแปฉng
8
Vฤn bแบฃn rรต 
ฤแบงu vรo
Vฤn bแบฃn mรฃ hoรก
Vฤn bแบฃn rรต 
ฤแบงu ra
Khoรก
(KE)
Giแบฃi mรฃ 
(Decrypt)
Khoรก (Key) lร chuแปi dแปฏ liแปu cแบงn thiแบฟt cho cแบฃ 
quรก trรฌnh giแบฃi mรฃ vร mรฃ hoรก
ฤแปc lแบญp vแปi bแบฃn rรต
Mรฃ hoรก (Encrypt) lร quรก trรฌnh chuyแปn 
vฤn bแบฃn rรต thรnh vฤn bแบฃn mรฃ hoรก
P
Bแบฃn rรต (Plaintext)
C
Bแบฃn mรฃ (Ciphertext)
C = E(P)
Giแบฃi mรฃ (Decrypt) lร quรก trรฌnh ฤฦฐa vฤn 
bแบฃn mรฃ hoรก vแป lแบกi vฤn bแบฃn gแปc ฤแบงu vรo
P = D(C)
Mรฃ hoรก
(Encrypt)
Khoรก
(KD)

1 โ GIแปI THIแปU CHUNG
ยก Cรกc khรกi niแปm cฦก bแบฃn
ยก Mแบญt mรฃ: lร chuyรชn ngรnh khoa hแปc cแปงa KHMT nghiรชn cแปฉu vแป cรกc nguyรชn lรฝ vร
phฦฐฦกng phรกp mรฃ hoรก. Hiแปn nay ngฦฐแปi ta ฤฦฐa ra nhiแปu chuแบฉn an toรn cho cรกc lฤฉnh
vแปฑc khรกc nhau cแปงa CNTT.
ยก Thรกm mรฃ: nghiรชn cแปฉu cรกc nguyรชn lรฝ vร phฦฐฦกng phรกp giแบฃi mรฃ mร khรดng biแบฟt khoรก.
Thรดng thฦฐแปng khi ฤฦฐa cรกc mรฃ mแบกnh ra lรm chuแบฉn dรนng chung giแปฏa cรกc ngฦฐแปi sแปญ
dแปฅng, cรกc mรฃ ฤรณ ฤฦฐแปฃc cรกc kแบป thรกm mรฃ cลฉng nhฦฐ nhแปฏng ngฦฐแปi phรกt triแปn mรฃ tรฌm
hiแปu nghiรชn cแปฉu cรกc phฦฐฦกng phรกp giแบฃi mแปt phแบงn bแบฃn mรฃ vแปi cรกc thรดng tin khรดng
ฤแบงy ฤแปง.
ยก Lรฝ thuyแบฟt mรฃ: gแปm cแบฃ mแบญt mรฃ vร thรกm mรฃ, lร mแปt thแป thแปng nhแบฅt, ฤแป ฤรกnh giรก
mแปt mรฃ mแบกnh hay khรดng, ฤแปu phแบฃi xรฉt tแปซ cแบฃ hai khรญa cแบกnh.
9

1 โ GIแปI THIแปU CHUNG
ยก Cรกc yรชu cแบงu ฤแป sแปญ dแปฅng an toรn hแป mรฃ hรณa
ยก Thuแบญt toรกn mรฃ hoรก mแบกnh: Cรณ cฦก sแป toรกn hแปc vแปฏng chแบฏc ฤแบฃm bแบฃo rแบฑng mแบทc dรน
cรดng khai thuแบญt toรกn, mแปi ngฦฐแปi ฤแปu biแบฟt, nhฦฐng viแปc thรกm mรฃ lร rแบฅt khรณ khฤn vร
phแปฉc tแบกp nแบฟu khรดng biแบฟt khรณa.
ยก Khoรก mแบญt chแป cรณ ngฦฐแปi gแปญi vร ngฦฐแปi nhแบญn biแบฟt: Cรณ kรชnh an toรn ฤแป phรขn phแปi
khoรก giแปฏa cรกc ngฦฐแปi sแปญ dแปฅng chia sแบป khรณa, mแปi liรชn hแป giแปฏa khรณa vร bแบฃn mรฃ lร
khรดng nhแบญn biแบฟt ฤฦฐแปฃc.
10
ยก ฤแบทc trฦฐng cแปงa hแป mรฃ hรณa
ยก Kiแปu cแปงa thao tรกc mรฃ hoรก ฤฦฐแปฃc sแปญ dแปฅng trรชn bแบฃn rรต.
ยก Sแป lฦฐแปฃng khoรก ฤฦฐแปฃc sแปญ dแปฅng khi mรฃ hรณa: mแปt khoรก duy nhแบฅt (khoรก riรชng) hoแบทc
hai khoรก (khoรก cรดng khai).
ยก Cรกch mร bแบฃn rรต ฤฦฐแปฃc xแปญ lรฝ: Theo khแปi hay dรฒng.

1 โ GIแปI THIแปU CHUNG
ยก Thรกm mรฃ
ยก Tแบฅn cรดng thรกm mรฃ dแปฑa trรชn thuแบญt toรกn vร mแปt sแป thรดng tin vแป cรกc ฤแบทc trฦฐng
chung vแป bแบฃn rรต nhแบฑm khai phรก cรกc ฤแบทc trฦฐng cแปงa thuแบญt toรกn ฤแป tรฌm bแบฃn rรต cแปฅ thแป
hoแบทc tรฌm khรณa.
ยก Tแบฅn cรดng duyแปt toรn bแป (Brute-Force): kแบป tแบฅn cรดng tรฌm cรกch thแปญ mแปi khรณa trรชn
bแบฃn mรฃ cho ฤแบฟn khi nhแบญn ฤฦฐแปฃc bแบฃn rรต.
ยก Cรกc kiแปu tแบฅn cรดng thรกm mรฃ:
ยก Chแป dรนng bแบฃn mรฃ: biแบฟt thuแบญt toรกn bแบฃn mรฃ, dรนng phฦฐฦกng phรกp thแปng kรช, xรกc ฤแปnh bแบฃn rรต.
ยก Biแบฟt bแบฃn rรต: biแบฟt thuแบญt toรกn, biแบฟt ฤฦฐแปฃc bแบฃn mรฃ/bแบฃn rรต tแบฅn cรดng tรฌm khรณa.
ยก Chแปn bแบฃn rรต: chแปn bแบฃn rรต vร nhแบญn ฤฦฐแปฃc bแบฃn mรฃ, biแบฟt thuแบญt toรกn tแบฅn cรดng tรฌm khรณa.
ยก Chแปn bแบฃn mรฃ: chแปn bแบฃn mรฃ vร cรณ ฤฦฐแปฃc bแบฃn rรต tฦฐฦกng แปฉng, biแบฟt thuแบญt toรกn tแบฅn cรดng tรฌm
khรณa.
ยก Chแปn bแบฃn tin: chแปn ฤฦฐแปฃc bแบฃn rรต hoแบทc mรฃ vร mรฃ hoแบทc giแบฃi mรฃ tuฦกng แปฉng, tแบฅn cรดng tรฌm
khรณa.
11

1 โ GIแปI THIแปU CHUNG
ยก ฤแป an toรn cแปงa hแป mรฃ hoรก
ยก An toรn khรดng ฤiแปu kiแปn: Khรดng phแปฅ thuแปc vรo mรกy tรญnh,โฆ
ยก An toรn tรญnh toรกn: Nguแปn lแปฑc mรกy tรญnh, thแปi gian cรณ hแบกn.
12

1 โ GIแปI THIแปU CHUNG
13
ยก Phรขn loแบกi mรฃ hoรก
ยก Mรฃ hoรก khoรก ฤแปi xแปฉng (Symmetric Cryptosystems)
Vฤn bแบฃn rรต 
ฤแบงu vรo
Vฤn bแบฃn mรฃ hoรก
Vฤn bแบฃn rรต 
ฤแบงu ra
Mรฃ hoรก
(Encrypt)
Giแบฃi mรฃ 
(Decrypt)
Hแป thแปng mรฃ hoรก ฤแปi xแปฉng chแป sแปญ dแปฅng 
mแปt khoรก ฤแป mรฃ hoรก vร giแบฃi mรฃ
Cรณ thแป ฤฦฐแปฃc gแปi lร hแป thแปng mแบญt mรฃ khoรก 
riรชng (Private key cryptosystem)
๐๐ = ๐๐

1 โ GIแปI THIแปU CHUNG
14
ยก Phรขn loแบกi mรฃ hoรก
ยก Mรฃ hoรก khoรก ฤแปi xแปฉng (Symmetric Cryptosystems)
Mรฃ hoรก cแป ฤiแปn (Classical cryptographic)
Sแปญ dแปฅng thuแบญt toรกn cแป ฤiแปn cฦก bแบฃn: 
thay thแบฟ (substitution), hoรกn vแป (transposition)
Mรฃ hoรก hiแปn ฤแบกi (Modern cryptographic)
Sแปญ dแปฅng thuแบญt toรกn hiแปn ฤแบกi:
Biแปu diแปn dแปฏ liแปu thรดng qua giรก trแป nhแป phรขn 
Mรฃ Caesar
Mรฃ hoรก ฤฦกn bแบฃng
Mรฃ hoรก Vigenรจre
One-Time Pad (OTP)
Mรฃ dรฒng (Stream cipher)
Mรฃ A5/1
Mรฃ RC4
Mรฃ khแปi (Block cipher)
DES
AES

1 โ GIแปI THIแปU CHUNG
15
ยก Phรขn loแบกi mรฃ hoรก
ยก Mรฃ hoรก khoรก bแบฅt ฤแปi xแปฉng (Asymmetric Cryptosystems)
Vฤn bแบฃn rรต 
ฤแบงu vรo
Vฤn bแบฃn mรฃ hoรก
Vฤn bแบฃn rรต 
ฤแบงu ra
Mรฃ hoรก
(Encrypt)
Giแบฃi mรฃ 
(Decrypt)
Hแป thแปng mรฃ hoรก bแบฅt ฤแปi xแปฉng sแปญ dแปฅng 
cรกc khoรก khรกc nhau, mแปt khoรก cรดng khai 
vร mแปt khoรก riรชng ฤแป mรฃ hoรก vร giแบฃi mรฃ
Cรณ thแป ฤฦฐแปฃc gแปi lร hแป thแปng mแบญt mรฃ khoรก 
cรดng khai (Public key cryptosystem)
Mรฃ hoรก: sแปญ dแปฅng khoรก cรดng khai
Giแบฃi mรฃ: sแปญ dแปฅng khoรก riรชng
๐๐ โ ๐๐

2 โ Mร HOร ฤแปI XแปจNG Cแป ฤIแปN
ยก Giแปi thiแปu
ยก Hแป mรฃ hoรก cแป ฤiแปn thay thแบฟ
ยก Hแป mรฃ hoรก cแป ฤiแปn hoรกn vแป
ยก Mแปt sแป vแบฅn ฤแป khรกc * (ฤแปc nรขng cao)
16

2 โ Mร HOร ฤแปI XแปจNG Cแป ฤIแปN
ยก Giแปi thiแปu
ยก Mรฃ hoรก ฤแปi xแปฉng cแป ฤiแปn lร phฦฐฦกng phรกp mรฃ hoรก ฤฦกn giแบฃn nhแบฅt xuแบฅt hiแปn ฤแบงu tiรชn
trong lแปch sแปญ ngรnh mรฃ hoรก, thuแบญt toรกn ฤฦกn giแบฃn vร dแป hiแปu, lร cฦก sแป cho viแปc
nghiรชn cแปฉu vร phรกt triแปn thuแบญt toรกn mรฃ hoรก ฤแปi xแปฉng ฤฦฐแปฃc sแปญ dแปฅng ngรy nay. Mรฃ
hoรก cแป ฤiแปn cรณ hai phฦฐฦกng phรกp nแปi bแบญt lร:
ยก Mรฃ hoรก thay thแบฟ
ยก Mรฃ hoรก hoรกn vแป
17

2.1 โ Hแป Mร HOร Cแป ฤIแปN THAY THแบพ
ยก Khรกi niแปm: lร phฦฐฦกng phรกp mร tแปซng kรญ tแปฑ (nhรณm kรญ tแปฑ) trong bแบฃn rรต
ฤฦฐแปฃc thay thแบฟ bแบฑng mแปt kรญ tแปฑ (mแปt nhรณm kรญ tแปฑ) khรกc ฤแป tแบกo ra bแบฃn
mรฃ. Bรชn nhแบญn chแป cแบงn thay thแบฟ ngฦฐแปฃc lแบกi trรชn bแบฃn mรฃ ฤแป cรณ ฤฦฐแปฃc bแบฃn
rรต ban ฤแบงu.
ยก Mแปt sแป hแป mรฃ:
ยก Hแป mรฃ ceasar
ยก Cรกc mรฃ bแบฃng chแปฏ ฤฦกn
ยก Hแป mรฃ Playfair
ยก Hแป mรฃ Vigenere
18

2.1 โ Hแป Mร HOร Cแป ฤIแปN THAY THแบพ
ยก Hแป mรฃ Caesar
ยก Phฦฐฦกng phรกp: Viแปc mรฃ hoรก ฤฦฐแปฃc thแปฑc hiแปn ฤฦกn giแบฃn lร thay mแปi chแปฏ trong bแบฃn rรต
bแบฑng chแปฏ thแปฉ ba tiแบฟp theo trong bแบฃng chแปฏ cรกi.
ยก Vรญ dแปฅ:
ยก Mรฃ hรณa bแบฃn rรต: โMeet me after the toga partyโ
ยก Bแบฃn mรฃ hรณa:โPHHW PH DIWHU WKH WRJD SDUWBโ
=> Nghฤฉa lร: ta thay chแปฏ โmโ bแบฑng chแปฏ ฤแปฉng thแปฉ 3 sau โmโ lร โpโ (m, n, o, p); thay
chแปฏ โeโ bแบฑng chแปฏ ฤแปฉng thแปฉ 3 sau โeโ lร โhโ (e, f, g, h),
ยก => Thรกm mรฃ: Ta chแป viแปc thay thแบฟ ngฦฐแปฃc lแบกi mแปi chแปฏ trong bแบฃn mรฃ.
19

2.1 โ Hแป Mร HOร Cแป ฤIแปN THAY THแบพ
ยก Cรกc mรฃ bแบฃng chแปฏ ฤฦกn
ยก Phฦฐฦกng phรกp: Mรฃ hoรก cรกc chแปฏ khรดng chแป lร dแปch chuyแปn bแบฃng chแปฏ, mร cรณ thแป tแบกo
ra cรกc bฦฐแปc nhแบฃy khรกc nhau cho cรกc chแปฏ. Trong mแปt mรฃ mแปi chแปฏ cแปงa bแบฃn rรต ฤฦฐแปฃc
รกnh xแบก ฤแบฟn mแปt chแปฏ khรกc nhau cแปงa bแบฃn mรฃ nรชn mแปi cรกch mรฃ nhฦฐ vแบญy sแบฝ tฦฐฦกng
แปฉng vแปi mแปt hoรกn vแป cแปงa bแบฃng chแปฏ vร hoรกn vแป ฤรณ lร khoรก cแปงa mรฃ ฤรฃ cho.
ยก Vรญ dแปฅ: Mรฃ hรณa bแบฃn rรต: โifwewishtoreplacelettersโ, giแบฃ sแปญ cรณ bแบฃn mรฃ tฦฐฦกng แปฉng vแปi
bแบฃn rรต trong mรฃ bแบฃng chแปฏ ฤฦกn nhฦฐ sau:
ยก Plain: abcdefghijklmnopqrstuvwxyz
ยก Cipher: DKVQFIBJWPESCXHTMYAUOLRGZN
20

2.1 โ Hแป Mร HOร Cแป ฤIแปN THAY THแบพ
ยก Cรกc mรฃ bแบฃng chแปฏ ฤฦกn
ยก Vรญ dแปฅ: Mรฃ hรณa bแบฃn rรต: โifwewishtoreplacelettersโ, giแบฃ sแปญ cรณ bแบฃn mรฃ tฦฐฦกng แปฉng vแปi
bแบฃn rรต trong mรฃ bแบฃng chแปฏ ฤฦกn nhฦฐ sau:
ยก Plain: abcdefghijklmnopqrstuvwxyz
ยก Cipher: DKVQFIBJWPESCXHTMYAUOLRGZN
=> Ta cรณ bแบฃn mรฃ hรณa cแปงa bแบฃn rรต lร:
ยก Plaintext: ifwewishtoreplaceletters
ยก Ciphertext: WIRFRWAJUHYFTSDVFSFUUFYA
=> Thรกm mรฃ: Tรญnh toรกn tแบงn suแบฅt cแปงa cรกc chแปฏ trong bแบฃn mรฃ ; so sรกnh vแปi cรกc giรก trแป ฤรฃ
biแบฟt; tรฌm kiแบฟm cรกc chแปฏ ฤฦกn hay dรนng nhฦฐ: A-I-E, bแป ฤรดi NO vร bแป ba RST; vร cรกc bแป รญt
dรนng JK, X-Z; trรชn bแบฃng chแปฏ ฤฦกn cแบงn xรกc ฤแปnh cรกc chแปฏ dรนng cรกc bแบฃng bแป ฤรดi vร bแป ba trแปฃ
giรบp.
21

2.1 โ Hแป Mร HOร Cแป ฤIแปN THAY THแบพ
ยก Hแป mรฃ Playfair
ยก Phฦฐฦกng phรกp: Mแปi chแปฏ sแบฝ ฤฦฐแปฃc mรฃ bแบฑng mแปt sแป chแปฏ khรกc nhau tรนy thuแปc vรo cรกc
chแปฏ mร nรณ ฤแปฉng cแบกnh. Trong mรฃ Playfair, mแปi chแปฏ cรณ thแป ฤฦฐแปฃc mรฃ bแบฑng mแปt trong
7 chแปฏ khรกc nhau tรนy vรo chแปฏ cแบทp ฤรดi cรนng nรณ trong bแบฃn rรต sแปญ dแปฅng ma trแบญn khรณa
Playfair. Ma trแบญn khรณa Playfair ฤฦฐแปฃc thiแบฟt lแบญp nhฦฐ sau: Cho trฦฐแปc mแปt tแปซ lรm khoรก
(vแปi ฤiแปu kiแปn trong tแปซ khoรก khรดng cรณ chแปฏ cรกi nรo bแป lแบทp). Ta lแบญp ma trแบญn Playfair
lร ma trแบญn cแปก 5 x 5 dแปฑa trรชn tแปซ khoรก ฤรฃ cho vร gแปm cรกc chแปฏ trรชn bแบฃng chแปฏ cรกi,
ฤฦฐแปฃc sแบฏp xแบฟp theo thแปฉ tแปฑ nhฦฐ sau:
ยก Trฦฐแปc hแบฟt viแบฟt cรกc chแปฏ cแปงa tแปซ khoรก vรo cรกc hรng cแปงa ma trแบญn bแบฏt ฤแบงu tแปซ hรng thแปฉ nhแบฅt.
ยก Nแบฟu ma trแบญn cรฒn trแปng, viแบฟt cรกc chแปฏ khรกc trรชn bแบฃng chแปฏ cรกi chฦฐa ฤฦฐแปฃc sแปญ dแปฅng vรo cรกc รด
cรฒn lแบกi (viแบฟt theo mแปt trรฌnh tแปฑ qui ฦฐแปc nhฦฐ: tแปซ ฤแบงu bแบฃng chแปฏ cรกi cho ฤแบฟn cuแปi).
ยก Do cรณ 26 chแปฏ cรกi tiแบฟng Anh, nรชn thiแบฟu mแปt รด nรชn ta sแบฝ dแปn hai chแปฏ nรo ฤรณ vรo mแปt รด
chung (chแบณng hแบกn I vร J).
22

2.1 โ Hแป Mร HOร Cแป ฤIแปN THAY THแบพ
ยก Hแป mรฃ Playfair
ยก Ta lแบญp ma trแบญn Playfair lร ma trแบญn cแปก 5 x 5 dแปฑa trรชn tแปซ khoรก ฤรฃ cho vร gแปm cรกc
chแปฏ trรชn bแบฃng chแปฏ cรกi, ฤฦฐแปฃc sแบฏp xแบฟp theo thแปฉ tแปฑ nhฦฐ sau:
ยก Trฦฐแปc hแบฟt viแบฟt cรกc chแปฏ cแปงa tแปซ khoรก vรo cรกc hรng cแปงa ma trแบญn bแบฏt ฤแบงu tแปซ hรng thแปฉ nhแบฅt.
ยก Nแบฟu ma trแบญn cรฒn trแปng, viแบฟt cรกc chแปฏ khรกc trรชn bแบฃng chแปฏ cรกi chฦฐa ฤฦฐแปฃc sแปญ dแปฅng vรo cรกc รด
cรฒn lแบกi (viแบฟt theo mแปt trรฌnh tแปฑ qui ฦฐแปc nhฦฐ: tแปซ ฤแบงu bแบฃng chแปฏ cรกi cho ฤแบฟn cuแปi).
ยก Do cรณ 26 chแปฏ cรกi tiแบฟng Anh, nรชn thiแบฟu mแปt รด nรชn ta sแบฝ dแปn hai chแปฏ nรo ฤรณ vรo mแปt รด
chung (chแบณng hแบกn I vร J).
ยก Giแบฃ sแปญ dรนng tแปซ khoรก MONARCHY => Ta lแบญp ma trแบญn khoรก Playfair:
ยก MONAR
ยก CHYBD
ยก EFGIK
ยก LPQST
ยก UVWXZ
23

2.1 โ Hแป Mร HOร Cแป ฤIแปN THAY THแบพ
ยก Hแป mรฃ Playfair
=> Mรฃ hรณa vร giแบฃi mรฃ: Bแบฃn rรต ฤฦฐแปฃc mรฃ hoรก 2 chแปฏ cรนng mแปt lรบc theo qui tแบฏc:
ยก Chia bแบฃn rรต thรnh tแปซng cแบทp chแปฏ. Nแบฟu mแปt cแบทp nรo ฤรณ cรณ hai chแปฏ nhฦฐ nhau, thรฌ ta chรจn
thรชm mแปt chแปฏ lแปc chแบณng hแบกn X. Vรญ dแปฅ, trฦฐแปc khi mรฃ โballoonโ biแบฟn ฤแปi thรnh โba lx lo onโ.
ยก Nแบฟu cแบฃ hai chแปฏ trong cแบทp ฤแปu rฦกi vรo cรนng mแปt hรng, thรฌ mรฃ mแปi chแปฏ bแบฑng chแปฏ แป phรญa
bรชn phแบฃi nรณ trong cรนng hรng cแปงa ma trแบญn khรณa (cuแปn vรฒng quanh tแปซ cuแปi vแป ฤแบงu), chแบณng
hแบกn โarโ biแบฟn ฤแปi thรnh โRMโ
ยก Nแบฟu cแบฃ hai chแปฏ trong cแบทp ฤแปu rฦกi vรo cรนng mแปt cแปt, thรฌ mรฃ mแปi chแปฏ bแบฑng chแปฏ แป phรญa bรชn
dฦฐแปi nรณ trong cรนng cแปt cแปงa ma trแบญn khรณa (cuแปn vรฒng quanh tแปซ cuแปi vแป ฤแบงu), chแบณng hแบกn
โmuโ biแบฟn ฤแปi thรnh โCMโ
ยก Trong cรกc trฦฐแปng hแปฃp khรกc, mแปi chแปฏ trong cแบทp ฤฦฐแปฃc mรฃ bแปi chแปฏ cรนng hรng vแปi nรณ vร
cรนng cแปt vแปi chแปฏ cรนng cแบทp vแปi nรณ trong ma trแบญn khรณa. Chแบณng hแบกn, โhsโ mรฃ thรnh โBPโ, vร
โeaโ mรฃ thรnh โIMโ hoแบทc โJMโ (tuแปณ theo sแป thรญch)
=> Thรกm mรฃ: Sแปญ dแปฅng phฦฐฦกng phรกp thแปng kรช tแบงn suแบฅt.
24

2.1 โ Hแป Mร HOร Cแป ฤIแปN THAY THแบพ
ยก Hแป mรฃ Vigenere
ยก Phฦฐฦกng phรกp: lร viแปc tiแบฟn hรnh ฤแปng thแปi dรนng nhiแปu mรฃ Ceasar cรนng mแปt lรบc
trรชn bแบฃn rรต vแปi nhiแปu khoรก khรกc nhau, khoรก cho mแปi chแปฏ dรนng ฤแป mรฃ phแปฅ thuแปc
vรo vแป trรญ cแปงa chแปฏ ฤรณ trong bแบฃn rรต vร ฤฦฐแปฃc lแบฅy trong tแปซ khoรก theo thแปฉ tแปฑ tฦฐฦกng
แปฉng.
ยก Chi tiแบฟt nhฦฐ sau:
ยก Giแบฃ sแปญ khoรก lร mแปt chแปฏ cรณ ฤแป dรi d ฤฦฐแปฃc viแบฟt dแบกng K = K1 K2 โฆKd , trong ฤรณ K i nhแบญn
giรก trแป nguyรชn tแปซ 0 ฤแบฟn 25.
ยก Khi ฤรณ ta chia bแบฃn rรต thรnh cรกc khแปi gแปm d chแปฏ. Mแปi chแปฏ thแปฉ i trong khแปi chแป ฤแปnh dรนng
bแบฃng chแปฏ thแปฉ i vแปi tแปnh tiแบฟn lร K i giแปng nhฦฐ trong mรฃ Ceasar (trรชn thแปฑc tแบฟ khi mรฃ ta cรณ
thแป sแปญ dแปฅng lแบงn lฦฐแปฃt cรกc bแบฃng chแปฏ vร lแบทp lแบกi tแปซ ฤแบงu sau d chแปฏ cแปงa bแบฃn rรต).
ยก Vรฌ cรณ nhiแปu bแบฃng chแปฏ khรกc nhau nรชn cรนng mแปt chแปฏ แป cรกc vแป trรญ khรกc nhau sแบฝ cรณ cรกc bฦฐแปc
nhแบฃy khรกc nhau, lรm cho tแบงn suแบฅt cรกc chแปฏ trong bแบฃn mรฃ giรฃn tฦฐฦกng ฤแปi ฤแปu. Giแบฃi mรฃ lร
quรก trรฌnh lรm ngฦฐแปฃc lแบกi, nghฤฉa lร dรนng bแบฃn mรฃ vร tแปซ khoรก vแปi cรกc bแบฃng chแปฏ tฦฐฦกng แปฉng,
nhฦฐng vแปi mแปi chแปฏ sแปญ dแปฅng bฦฐแปc nhแบฃy lui lแบกi vแป ฤแบงu.
25

2.1 โ Hแป Mร HOร Cแป ฤIแปN THAY THแบพ
ยก Hแป mรฃ Vigenere
ยก ฤแป sแปญ dแปฅng mรฃ Vigenere vแปi tแปซ khรณa vร bแบฃn rรต, ta thแปฑc hiแปn cรกc bฦฐแปc:
ยก Viแบฟt bแบฃn rรต ra.
ยก Viแบฟt tแปซ khoรก lแบทp nhiแปu lแบงn phรญa trรชn tฦฐฦกng แปฉng cแปงa nรณ.
ยก Sแปญ dแปฅng mแปi chแปฏ cแปงa tแปซ khoรก nhฦฐ khoรก cแปงa mรฃ Ceasar.
ยก Mรฃ chแปฏ tฦฐฦกng แปฉng cแปงa bแบฃn rรต vแปi bฦฐแปc nhแบฃy tฦฐฦกng แปฉng.
26

2.1 โ Hแป Mร HOร Cแป ฤIแปN THAY THแบพ
ยก Hแป mรฃ Vigenere
ยก Vรญ dแปฅ: Sแปญ dแปฅng tแปซ khoรก deceptive mรฃ hรณa bแบฃn rรต nhฦฐ dฦฐแปi ฤรขy?
ยก key: deceptivedeceptivedeceptive
ยก plaintext: wearediscoveredsaveyourself
ยก ciphertext:ZICVTWQNGRZGVTWAVZHCQYGL
ยก Thแปฑc hiแปn: ฤแป mรฃ chแปฏ w, ta tรฌm chแปฏ ฤแบงu cแปงa khรณa lร d, do ฤรณ w sแบฝ ฤฦฐแปฃc mรฃ trรชn
bแบฃng chแปฏ tแปnh tiแบฟn 3 (tแปฉc lร a tแปnh tiแบฟn vรo d) nรชn chแปฏ ฤแบงu w ฤฦฐแปฃc mรฃ bแปi chแปฏ Z.
Chแปฏ thแปฉ hai trong tแปซ khรณa lร e, cรณ nghฤฉa lร chแปฏ thแปฉ hai trong bแบฃn rรต sแบฝ ฤฦฐแปฃc tแปnh
tiแบฟn 4 (tแปซ a tแปnh tiแบฟn ฤแบฟn e). Nhฦฐ vแบญy, chแปฏ thแปฉ hai trong bแบฃn rรต e sแบฝ ฤฦฐแปฃc mรฃ bแปi
chแปฏ I,โฆ. Tฦฐฦกng tแปฑ nhฦฐ vแบญy cho ฤแบฟn hแบฟt bแบฃn rรต
ยก => Thรกm mรฃ: Sแปญ dแปฅng phฦฐฦกng phรกp thแปng kรช tแบงn suแบฅt.
27

2.2 โ Hแป Mร HOร Cแป ฤIแปN HOรN Vแป
ยก Khรกi niแปm: Cรกc kรญ tแปฑ trong bแบฃn rรต vแบซn ฤฦฐแปฃc giแปฏ nguyรชn, chรบng chแป
ฤฦฐแปฃc sแบฏp xแบฟp lแบกi vแป trรญ ฤแป tแบกo ra bแบฃn mรฃ. Tแปฉc lร cรกc kรญ tแปฑ trong bแบฃn rรต
hoรn toรn khรดng bแป thay ฤแปi bแบฑng kรญ tแปฑ khรกc mร chแป ฤแบฃo chแป cแปงa
chรบng ฤแป tแบกo thรnh bแบฃn mรฃ. Cรณ mแปt sแป hแป mรฃ sau:
ยก Hแป mรฃ Rail Fence
ยก Hแป mรฃ dแปch chuyแปn dรฒng
28

2.2 โ Hแป Mร HOร Cแป ฤIแปN HOรN Vแป
ยก Hแป mรฃ Rail Fence:
ยก Phฦฐฦกng phรกp: Viแบฟt cรกc chแปฏ cแปงa bแบฃn rรต theo ฤฦฐแปng chรฉo (hรฌnh rฤng cฦฐa) trรชn mแปt
sแป dรฒng. Sau ฤรณ viแบฟt cรกc chแปฏ theo tแปซng dรฒng sแบฝ nhแบญn ฤฦฐแปฃc bแบฃn mรฃ. Sแป dรฒng chรญnh
lร khoรก cแปงa mรฃ (vรฌ khi biแบฟt sแป dรฒng ta sแบฝ tรญnh ฤฦฐแปฃc sแป chแปฏ trรชn mแปi dรฒng vร lแบกi
viแบฟt bแบฃn mรฃ theo cรกc dรฒng sau ฤรณ lแบฅy bแบฃn rรต bแบฑng cรกch viแบฟt lแบกi theo cรกc cแปt). Quรก
trรฌnh giแบฃi mรฃ ฤฦฐแปฃc thแปฑc hiแปn ngฦฐแปฃc lแบกi.
ยก Vรญ dแปฅ: Mรฃ hรณa bแบฃn rรต โmeet me after the toga party โ vแปi khรณa K = 2 (sแป dรฒng
bแบฑng 2)?
ยก Giแบฃi: Ta viแบฟt bแบฃn rรต โmeet me after the toga partyโ lแบงn lฦฐแปฃt trรชn 2 dรฒng:
m e m a t r h t g p r y
e t e f e t e o a a t
ยก Sau ฤรณ ghรฉp cรกc chแปฏ แป dรฒng thแปฉ nhแบฅt vแปi cรกc chแปฏ แป dรฒng thแปฉ hai cho bแบฃn mรฃ:
MEMATRHTGPRYETEFETEOAAT
ยก => Thรกm mรฃ: ฤฦกn giแบฃn.
29

2.2 โ Hแป Mร HOร Cแป ฤIแปN HOรN Vแป
ยก Hแป mรฃ dแปch chuyแปn dรฒng:
ยก Phฦฐฦกng phรกp: Viแบฟt cรกc chแปฏ cแปงa bแบฃn rรต theo cรกc dรฒng vแปi sแป cแปt xรกc ฤแปnh. Sau ฤรณ
thay ฤแปi thแปฉ tแปฑ cรกc cแปt theo mแปt dรฃy sแป khoรก cho truแปc, rแปi ฤแปc lแบกi chรบng theo cรกc
cแปt ฤแป nhแบญn ฤฦฐแปฃc bแบฃn mรฃ. Quรก trรฌnh giแบฃi mรฃ ฤฦฐแปฃc thแปฑc hiแปn ngฦฐแปฃc lแบกi.
ยก Vรญ dแปฅ: Thแปฑc hiแปn mรฃ hรณa bแบฃn rรต (sแป cแปt bแบฑng 7) vแปi khรณa nhฦฐ dฦฐแปi ฤรขy?
ยก Giแบฃi: Key:
4 3 1 2 5 6 7
ยก Plaintext:
a t t a c k p
o s t p o n e
d u n t
i l t
w o a m x y z
Sau ฤรณ, ta viแบฟt theo thแปฉ tแปฑ cรกc cแปt tแปซ 1 ฤแบฟn 7 ฤแป nhแบญn ฤฦฐแปฃc bแบฃn mรฃ: Ciphertext:
TTNAAPTMTSUOAODWCOIXKNLYPETZ
=> Thรกm mรฃ: ฤฦกn giแบฃn.
30

2.2 โ Hแป Mร HOร Cแป ฤIแปN HOรN Vแป
ยก ฤiแปm yแบฟu cแปงa mรฃ cแป ฤiแปn:
ยก Phฦฐฦกng phรกp mรฃ hoรก cแป ฤiแปn cรณ thแป dแป dรng bแป giแบฃi mรฃ bแบฑng cรกch
ฤoรกn chแปฏ dแปฑa trรชn phฦฐฦกng phรกp thแปng kรช tแบงn suแบฅt xuแบฅt hiแปn cรกc chแปฏ
cรกi trรชn mรฃ vร so sรกnh vแปi bแบฃng thแปng kรช quan sรกt cแปงa bแบฃn rรต.
ยก ฤแป dรนng ฤฦฐแปฃc mรฃ hoรก cแป ฤiแปn thรฌ bรชn mรฃ hoรก vร bรชn giแบฃi mรฃ phแบฃi
thแปng nhแบฅt vแปi nhau vแป cฦก chแบฟ mรฃ hoรก cลฉng nhฦฐ giแบฃi mรฃ.
31

3 โ Mร HOร ฤแปI XแปจNG HIแปN ฤแบI
ยก Giแปi thiแปu
ยก Mรฃ hoรก dรฒng (Stream Cipher)
ยก Mรฃ hoรก khแปi (Block Cipher)
32

3 โ Mร HOร ฤแปI XแปจNG HIแปN ฤแบI
ยก Giแปi thiแปu
ยก ฤแปi tฦฐแปฃng mรฃ hรณa cแปงa cรกc phฦฐฦกng phรกp mรฃ hoรก ฤแปi xแปฉng
cแป ฤiแปn chแป lร cรกc chแปฏ cรกi, trong khi ฤรณ bแบฃn tin hiแปn nay cรณ
thแป lร hรฌnh แบฃnh, video, รขm thanh, kรฝ tแปฑ ฤแบทc biแปt,.. =>
Ngoรi ra, rแบฅt quan tรขm ฤแบฟn vแบฅn ฤแป chแปng phรก mรฃ trong
cรกc hแป mรฃ nรชn cรกc hแป mรฃ hรณa hiแปn ฤแบกi ฤฦฐแปฃc phรกt triแปn.
ยก ฤแป minh hแปa mรฃ hรณa ฤแปi xแปฉng hiแปn ฤแบกi, ta sแปญ dแปฅng bแบฃn rรต
lร cรกc chแปฏ cรกi cแปงa mแปt ngรดn ngแปฏ gแปm cรณ 8 chแปฏ cรกi: A, B,
C, D, E, F, G, H; trong ฤรณ mแปi chแปฏ cรกi ฤฦฐแปฃc biแปu diแปn bแบฑng
3 bรญt nhแป phรขn nhฦฐ bแบฃng sau:
33
Chแปฏ cรกi
Nhแป phรขn
A
000
B
001
C
010
D
011
E
100
F
101
G
110
H
111

3 โ Mร HOร ฤแปI XแปจNG HIแปN ฤแบI
ยก Giแปi thiแปu
ยก Giแบฃ sแปญ bแบฃn rรต lร cรกc chแปฏ cรกi cแปงa mแปt ngรดn ngแปฏ gแปm 8 chแปฏ cรกi: 
A, B, C, D, E, F, G, H; lแบงn lฦฐแปฃt ฤฦฐแปฃc biแปu diแปn bแบฑng 4 bรญt nhฦฐ 
bแบฃng sau:
ยก Nแบฟu bแบฃn rรต lร โHEADโ thรฌ biแปu diแปn nhแป phรขn: 111100000111
ยก Sแปญ dแปฅng khoรก K gแปm 4 bรญt ฤแป mรฃ hoรก bแบฃn rรต lร: 0101
ยก Mรฃ hoรก bแบฃn rรต bแบฑng phรฉp XOR (ร) vแปi khoรก K:
1111 0000 0111 ร 0101 0101 0101 = 1010 0101 0110 (FBCG)
ยก Giแบฃi mรฃ: lแบฅy bแบฃn mรฃ XOR vแปi khoรก ฤแป thu ฤฦฐแปฃc bแบฃn rรต
ร Phฦฐฦกng phรกp XOR nhฦฐ trรชn khรก ฤฦกn giแบฃn, do ฤรณ ra ฤแปi mรฃ hoรก 
phแปฉc tแบกp hฦกn
ร Cรณ 2 phฦฐฦกng phรกp mรฃ hoรก ฤแปi xแปฉng hiแปn ฤแบกi: Mรฃ hoรก dรฒng 
(Stream Cipher) vร mรฃ hoรก khแปi (Block Cipher)
34
Chแปฏ cรกi
Nhแป phรขn
A
000
B
001
C
010
D
011
E
100
F
101
G
110
H
111

3.1 โ Mร DรNG
ยก Mรฃ dรฒng (Stream Cipher)
ยก Quรก trรฌnh mรฃ hoรก:
(1) Bแบฃn rรต ฤฦฐแปฃc chia thรnh cรกc ฤฦกn vแป mรฃ hoรก (mแปi ฤฦกn vแป cรณ kรญch thฦฐแปc k bit):
๐ โ p!p"p# โฆ p$%"
p& โถ k bit
p!
p"
โฆ
p#$"
c!
c"
โฆ
c#$"
s!
๐
๐
(2) Mแปt bแป sinh dรฃy sแป ngแบซu nhiรชn: Dรนng khoรก K ban ฤแบงu ฤแป sinh ra cรกc sแป ngแบซu 
nhiรชn cรณ kรญch thฦฐแปc bแบฑng kรญch thฦฐแปc ฤฦกn vแป mรฃ hoรก:
StreamCipher K โ S = s!s"s# โฆ s$%"
s& โถ k bit
(3) Mแปi sแป ngแบซu nhiรชn ฤฦฐแปฃc XOR vแปi ฤฦกn vแป mรฃ hoรก cแปงa bรฃn rรต ฤแป ฤฦฐแปฃc bแบฃn mรฃ:
c! = p! โ s!, c" = p" โ s", โฆ ; C = c!c"c# โฆ c$%"
s"
s#$"
35

3.1 โ Mร DรNG
ยก Mรฃ dรฒng (Stream Cipher)
ยก Quรก trรฌnh giแบฃi mรฃ:
Quรก trรฌnh giแบฃi mรฃ ฤฦฐแปฃc thแปฑc hiแปn ngฦฐแปฃc lแบกi, bแบฃn mรฃ C ฤฦฐแปฃc XOR vแปi dรฃy sแป ngแบซu 
nhiรชn S ฤแป cho ra lแบกi bแบฃn rรต ban ฤแบงu:
p! = c! โ s!, p" = c" โ s", โฆ
p!
p"
โฆ
p#$"
c!
c"
โฆ
c#$"
s!
๐
๐
s"
s#$"
p!
p"
โฆ
p#$"
s!
๐
s"
s#$"
36

3.1 โ Mร DรNG
ยก Mรฃ dรฒng (Stream Cipher)
ยก Vรญ dแปฅ 1:
Cho P=111100000011 (Chแปฏ โHEADโ) ฤฦกn vแป mรฃ hoรก cรณ chiแปu dรi k = 4 bรญt vร n =3
s! = 0101, s" = 1010, s# = 1100
p! = 1111
p" = 0000
p% = 0011
c! = 1010
c" = 1010
c% = 1111
s! = 0101
๐
๐
s" = 1010
s% = 1100
p! = 1111
p" = 0000
p% = 0011
s! = 0101
s" = 1010
s% = 1100
๐
Chแปฏ cรกi
Nhแป phรขn
A
000
B
001
C
010
D
011
E
100
F
101
G
110
H
111
37

3.1 โ Mร DรNG
ยก Hแป mรฃ A5/1
Giแปi thiแปu: 
ยก A5/1 ฤฦฐแปฃc dรนng trong mแบกng ฤiแปn thoแบกi GSM, ฤแป bแบฃo mแบญt dแปฏ liแปu trong quรก trรฌnh 
liรชn lแบกc giแปฏa mรกy tรญnh ฤiแปn thoแบกi vร trแบกm thu phรกt sรณng vรด tuyแบฟn
ยก ฤฦกn vแป mรฃ hoรก cแปงa A5/1 lร 1 bรญt. Bแป sinh sแป mแปi lแบงn sแบฝ sinh ra hoแบทc bรญt 0 hoแบทc bรญt 
1 ฤแป sแปญ dแปฅng trong phรฉp XOR
ร Trong bรi hแปc giแปi hแบกn xรฉt mรด hรฌnh thu nhแป cแปงa A5/1, gแปi tแบฏt lร TinyA5/1
38

3.1 โ Mร DรNG
ยก Hแป mรฃ TinyA5/1
ยก Bแป sinh sแป gแปm 3 thanh ghi X, Y, Z:
ยก
X gแปm 6 bรญt (x!, x", โฆ , x&)
ยก
Y gแปm 8 bรญt (y!, y", โฆ , y')
ยก
Z gแปm 9 bรญt (z!, z", โฆ , z()
ยก Khoรก K cรณ chiแปu dรi 23 bรญt lร ฤฦฐแปฃc phรขn bแป vรo cรกc thanh ghi: K โถ XYZ
ยก Cรกc thanh ghi X, Y, Z ฤฦฐแปฃc biแบฟn ฤแปi theo cรกc quy tแบฏc quay
39

3.1 โ Mร DรNG
ยก Hแป mรฃ TinyA5/1
ยก ฤแบงu vรo: P, K
ยก Nแปi dung thuแบญt toรกn:
ยก ฤแบงu ra: C
Phรขn bแป K vรo cรกc thanh ghi XYZ
Tแบกi bฦฐแปc sinh sแป thแปฉ i, thแปฑc hiแปn cรกc phรฉp tรญnh:
Tรญnh m = maj(x", y', z') lร โhรm chiแบฟm ฤa sแปโ. Nแบฟu trong 3 bรญt x", y', z' cรณ tแปซ 
hai bรญt 0 trแป lรชn thรฌ hรm trแบฃ vแป giรก trแป 0; Ngฦฐแปฃc lแบกi, hรm trแบฃ vแป giรก trแป 1.
Kiแปm tra:
Nแบฟu x" = m thรฌ thแปฑc hiแปn Quay X;
Nแบฟu y' = m thรฌ thแปฑc hiแปn Quay Y;
Nแบฟu z' = m thรฌ thแปฑc hiแปn Quay Z;
Tรญnh s& = x( โจ y)โจz*
Bแบฃn mรฃ C = P ๐๐๐ S
40

3.1 โ Mร DรNG
ยก Hแป mรฃ TinyA5/1
ยก Quay X gแปm cรกc thao tรกc:
ยก t = x% โจ x) โจ x&
ยก x* = x*$" vแปi j = 5, 4, 3, 2, 1
ยก x! = t
1
0
0
1
0
1
0
1
2
3
4
5
t = 0 โจ0 โจ1 = 1
1
1
0
0
1
0
ยก Quay Y gแปm cรกc thao tรกc:
ยก
t = y+ โจ y'
ยก
y* = y*$" vแปi j = 7, 6, โฆ , 1
ยก
y! = t
๐
0
1
0
0
1
1
1
0
0
1
2
3
4
5
6
7
t = 0 โจ1 = 1
๐
1
0
1
0
0
1
1
1
ยก Quay Z gแปm cรกc thao tรกc:
ยก
t = z% โจ z' โจ z(
ยก
z* = z*$" vแปi j = 8, 7, โฆ , 1
ยก
z! = t
1
0
0
1
1
0
0
0
0
0
1
2
3
4
5
6
7
8
t = 0 โจ0 โจ0 = 0
๐
0
1
0
0
1
1
0
0
0
41

3.1 โ Mร DรNG
ยก Bรi tแบญp: Cho bแบฃn rรต P = 111 (chแปฏ H), khoรก K = 10010101001110100110000
X
100101
Y
01001110
Z
100110000
ยก Bฦฐแปc 0: x" = 0, y' = 0, z' = 1 โ m = maj(0,0,1) = 0 โ quay X, quay Y  
100101
110010
X
01001110
10100111
Y
100110000
Z
s! = 0 โจ 1 โจ 0=1
ยก Bฦฐแปc 1: x" = 1, y' = 0, z' = 1 โ m = maj 1,0,1 = 1 โ quay X, quay Z  
110010
111001
X
100110000
010011000
Z
10100111
Y
s" = 1 โจ 1 โจ 0=0
Phรขn bแป
ยก Hแป mรฃ TinyA5/1
ยก Bฦฐแปc 2: x" = 1, y' = 0, z' = 0 โ m = maj(1,0,0) = 0 โ quay Y, quay Z  
(Cรฒn tiแบฟp)
42

3.1 โ Mร DรNG
ยก Bฦฐแปc 2: x" = 1, y' = 0, z' = 0 โ m = maj 1,0,0 = 0 โ quay Y, quay Z  
10100111
01010011
Y
010011000
101001100
Z
111001
X
s% = 1 โจ 1 โจ 0=0
ยก Vแบญy bแบฃn mรฃ lร C = 111 โจ 100 = 011 (chแปฏ D)
ยก Giแบฃi mรฃ: P = C โจ S = 011 โจ 100 = 111 
ยก Bรi tแบญp: Cho bแบฃn rรต P = 111 (chแปฏ H), khoรก K = 10010101001110100110000
X
100101
Y
01001110
Z
100110000
Phรขn bแป
ยก Hแป mรฃ TinyA5/1
43

3.1 โ Mร DรNG
ยก Hแป mรฃ A5/1 (Tแปng quรกt)
ยก ฤแบทc ฤiแปm: Nguyรชn tแบฏc bแป sแป A5/1 hoแบกt ฤแปng giแปng TinyA5/1 nhฦฐng kรญch thฦฐแปc 
thanh ghi X, Y, Z lร 19, 22 vร 23 bรญt
ยก Hรm maj ฤฦฐแปฃc tรญnh trรชn 3 bรญt: m = maj(x*, y"!, z"!)
ยก Quay X, Y, Z vแปi cรกc bรญt nhฦฐ sau:
ยก Sau khi quay bรญt xong thรฌ bรญt sinh ra: s& = x* โจ y"!โจz"!  
ยก A5/1 ฤฦฐแปฃc thแปฑc hiแปn dแป dรng bแบฑng cรกc thiแบฟt bแป phแบงn cแปฉng, tแปc ฤแป nhanh
ยก Quay X :
ยก
t = x", โจ x"+ โจ x"', โจ x"(
ยก
x* = x*$" vแปi j = 18, 17, โฆ , 1
ยก
x! = t
ยก Quay Y:
ยก
t = y%! โจ y%"
ยก
y* = y*$" vแปi j = 21, 20, โฆ , 1
ยก
y! = t
ยก Quay Z:
ยก
t = z' โจ z%! โจ z%"โจ z%%
ยก
z* = z*$" vแปi j = 22, 21, โฆ , 1
ยก
z! = t
44

3.1 โ Mร DรNG
ยก Hแป mรฃ A5/1 (Tแปng quรกt)
ยก ฤแบทc ฤiแปm: Nguyรชn tแบฏc bแป sแป A5/1 hoแบกt ฤแปng giแปng TinyA5/1 nhฦฐng kรญch thฦฐแปc 
thanh ghi X, Y, Z lร 19, 22 vร 23 bรญt
ยก Hรm maj ฤฦฐแปฃc tรญnh trรชn 3 bรญt: m = maj(x*, y"!, z"!)
ยก Quay X, Y, Z vแปi cรกc bรญt nhฦฐ sau:
ยก Sau khi quay bรญt xong thรฌ bรญt sinh ra: s& = x* โจ y"!โจz"!  
ยก A5/1 ฤฦฐแปฃc thแปฑc hiแปn dแป dรng bแบฑng cรกc thiแบฟt bแป phแบงn cแปฉng, tแปc ฤแป nhanh
ยก Quay X :
ยก
t = x", โจ x"+ โจ x"', โจ x"(
ยก
x* = x*$" vแปi j = 18, 17, โฆ , 1
ยก
x! = t
ยก Quay Y:
ยก
t = y%! โจ y%"
ยก
y* = y*$" vแปi j = 21, 20, โฆ , 1
ยก
y! = t
ยก Quay Z:
ยก
t = z' โจ z%! โจ z%"โจ z%%
ยก
z* = z*$" vแปi j = 22, 21, โฆ , 1
ยก
z! = t
45

ยก Hแป mรฃ RC4
ยก Giแปi thiแปu: RC4 lร hแป mรฃ ฤฦฐแปฃc sแปญ dแปฅng trong giao thแปฉc SSL ฤแป bแบฃo mแบญt dแปฏ liแปu 
trong quรก trรฌnh truyแปn dแปฏ liแปu giแปฏa Web Server vร trรฌnh duyแปt Web
ยก RC4 cรฒn ฤฦฐแปฃc sแปญ dแปฅng trong mรฃ hoรก WEP cแปงa mแบกng Wireless LAN
ยก Trong giแปi hแบกn bรi hแปc xรฉt mรด hรฌnh thu nhแป cแปงa RC4, gแปi tแบฏt lร TinyRC4
ยก Hแป mรฃ TinyRC4: 
ยก ฤฦกn vแป mรฃ hoรก cแปงa TinyRC4 lร 3 bรญt
ยก TinyRC4 dรนng 2 mแบฃng lร S vร T mแปi mแบฃng gแปm 8 sแป nguyรชn 3 bรญt (tแปซ 0 ฤแบฟn 7)
ยก Khoรก lร mแปt dรฃy gแปm N sแป nguyรชn 3 bรญt vแปi N cรณ thแป lแบฅy giรก trแป tแปซ 1 ฤแบฟn 8. Bแป 
sinh sแป mแปi lแบงn sinh ra 3 bรญt ฤแป sแปญ dแปฅng trong phรฉp XOR.
ยก Quรก trรฌnh sinh sแป cแปงa TinyRC4 gแปm 2 giai ฤoแบกn: Khแปi tแบกo vร Sinh sแป
3.1 โ Mร DรNG
46

3.1 โ Mร DรNG
ยก Hแป mรฃ TinyRC4
ยก Giai ฤoแบกn khแปi tแบกo
ยก Trฦฐแปc tiรชn, dรฃy S gแปm cรกc sแป nguyรชn 3 bรญt tแปซ 0 ฤแบฟn 7 ฤฦฐแปฃc sแบฏp thแปฉ tแปฑ tฤng dแบงn
ยก Dแปฑa trรชn cรกc phแบงn tแปญ cแปงa khoรก K, cรกc phแบงn tแปญ cแปงa S ฤฦฐแปฃc hoรกn vแป lแบซn nhau ฤแบฟn 
mแปt mแปฉc ฤแป ngแบซu nhiรชn nhแบฅt ฤแปnh
# Khoi tao day so S va T
for i = 0 to 7 do
     S[i] = i;
     T[i] = K[i mod N];
next i
# Hoan vi day S
j=0
for i = 0 to 7 do
     j = (j + S[i] + T[i]) mod 8;
     Swap(S[i], S[j]);
next j
47

3.1 โ Mร DรNG
ยก Hแป mรฃ TinyRC4
ยก Giai ฤoแบกn sinh sแป
ยก Cรกc phแบงn tแปญ cแปงa S tiแบฟp tแปฅc ฤฦฐแปฃc hoรกn vแป. Tแบกi mแปi bฦฐแปc sinh sแป, hai phแบงn tแปญ cแปงa 
dรฃy S ฤฦฐแปฃc chแปn ฤแป tรญnh ra sแป k 3 bรญt lร sแป ฤฦฐแปฃc dรนng ฤแป XOR vแปi ฤฦกn vแป mรฃ hoรก 
cแปงa bแบฃn rรต.
i, j = 0;
while (true):
     i = (i + 1) mod 8;
     j = (j + S[i]) mod 8;
     Swap(S[i], S[j]);
     t = (S[i] + S[j]) mod 8;
     k = S[t];
end while
48

3.1 โ Mร DรNG
ยก Hแป mรฃ TinyRC4
ยก Xรฉt vรญ dแปฅ: Cho bแบฃn rรต P = 001000110 (tแปซ โBAGโ), khoรก K gแปm 3 sแป 2, 1, 3 (N=3)
ยก Giai ฤoแบกn khแปi tแบกo: S vร T
# Khoi tao day so S va T
for i = 0 to 7 do
     S[i] = i;
     T[i] = K[i mod N];
next i
# Hoan vi day S
j=0
for i = 0 to 7 do
     j = (j + S[i] + T[i]) mod 8;
     Swap(S[i], S[j]);
next j
0
1
2
3
4
5
6
7
S
2
1
3
2
1
3
2
1
T
K
49

3.1 โ Mร DรNG
ยก Hแป mรฃ TinyRC4
ยก Xรฉt vรญ dแปฅ: Cho bแบฃn rรต P = 001000110 (tแปซ โBAGโ), khoรก K gแปm 3 sแป 2, 1, 3 (N=3)
ยก Giai ฤoแบกn khแปi tแบกo: S vร T
# Khoi tao day so S va T
for i = 0 to 7 do
     S[i] = i;
     T[i] = K[i mod N];
next i
# Hoan vi day S
j=0
for i = 0 to 7 do
     j = (j + S[i] + T[i]) mod 8;
     Swap(S[i], S[j]);
next j
0
1
2
3
4
5
6
7
S
2
1
3
2
1
3
2
1
T
ยก Hoรกn vแป S
2
1
3
2
1
3
2
1
T
i=0
j S[i]+T[i]=2
2
1
0
3
4
5
6
7
S
Swap(S[i], S[j])
2
1
3
2
1
3
2
1
T
i=1
j S[i]+T[i]=2
2
4
0
3
1
5
6
7
S
Swap(S[i], S[j])
50

3.1 โ Mร DรNG
ยก Hแป mรฃ TinyRC4
ยก Xรฉt vรญ dแปฅ: Cho bแบฃn rรต P = 001000110 (tแปซ โBAGโ), khoรก K gแปm 3 sแป 2, 1, 3 (N=3)
ยก Giai ฤoแบกn khแปi tแบกo: S vร T
# Khoi tao day so S va T
for i = 0 to 7 do
     S[i] = i;
     T[i] = K[i mod N];
next i
# Hoan vi day S
j=0
for i = 0 to 7 do
     j = (j + S[i] + T[i]) mod 8;
     Swap(S[i], S[j]);
next j
0
1
2
3
4
5
6
7
S
2
1
3
2
1
3
2
1
T
ยก Hoรกn vแป S
2
1
3
2
1
3
2
1
T
i=2
j S[i]+T[i]=3
2
4
7
3
1
5
6
0
S
Swap(S[i], S[j])
ยก Quรก trรฌnh thแปฑc hiแปn ฤแบฟn khi i = 7
ยก Kแบฟt quแบฃ cแปงa dรฃy S:
6
0
7
1
2
3
5
4
S
51

2
3.1 โ Mร DรNG
ยก Hแป mรฃ TinyRC4
ยก Xรฉt vรญ dแปฅ: Cho bแบฃn rรต P = 001000110 (tแปซ โBAGโ), khoรก K gแปm 3 sแป 2, 1, 3 (N=3)
ยก Giai ฤoแบกn sinh sแป:
6
0
7
1
2
3
5
4
S
i, j = 0;
while (true):
     i = (i + 1) mod 8;
     j = (j + S[i]) mod 8;
     Swap(S[i], S[j]);
     t = (S[i] + S[j]) mod 8;
     k = S[t];
end while
j S[i]
i 1
S[i]+ S[j]=0+6
โ s!= 5 = 101%
0
6
7
1
2
3
5
4
S
j S[i]
i
S[i]+ S[j]=4+7
โ s!= 1 = 001%
3
0
6
4
1
2
3
5
7
S
j S[i]
i
S[i]+ S[j]=0+1
โ s!= 6 = 110%
Bฦฐแปc 0:
Bฦฐแปc 1:
Bฦฐแปc 2:
52

3.1 โ Mร DรNG
ยก Hแป mรฃ TinyRC4
ยก Xรฉt vรญ dแปฅ: Cho bแบฃn rรต P = 001000110 (tแปซ โBAGโ), khoรก K gแปm 3 sแป 2, 1, 3 (N=3)
ยก Giai ฤoแบกn sinh sแป:
6
0
7
1
2
3
5
4
S
i, j = 0;
while (true):
     i = (i + 1) mod 8;
     j = (j + S[i]) mod 8;
     Swap(S[i], S[j]);
     t = (S[i] + S[j]) mod 8;
     k = S[t];
end while
โ s!= 5 = 101%
0
6
7
1
2
3
5
4
S
โ s!= 1 = 001%
0
6
4
1
2
3
5
7
S
โ s!= 6 = 110%
Bฦฐแปc 0:
Bฦฐแปc 1:
Bฦฐแปc 2:
ยก Vแบญy bแบฃn mรฃ lร C = 001 000 110 โจ 101 001 110 = 100 001 000 (tแปซ EBA)
ยก Giแบฃi mรฃ: P = C โจ S = 100 001 000 โจ 101 001 110 = 001 000 110 
53

3.1 โ Mร DรNG
ยก Hแป mรฃ RC4 (Tแปng quรกt)
ยก Cฦก chแบฟ hoแบกt ฤแปng cแปงa RC4 cลฉng giแปng TinyRC4 vแปi cรกc ฤแบทc ฤiแปm sau:
ยก ฤฦกn vแป mรฃ hoรก cแปงa RC4 lร mแปt byte 8 bรญt
ยก Mแบฃng S vร T gแปm 256 sแป nguyรชn 8 bรญt
ยก Khoรก K lร mแปt dรฃy gแปm N sแป nguyรชn 8 bรญt vแปi N cรณ thแป lแบฅy cรกc giรก trแป tแปซ 1 ฤแบฟn 
256
ยก Bแป sinh sแป mแปi lแบงn sinh ra mแปt byte ฤแป sแปญ dแปฅng trong phรฉp XOR
ยก RC4 cลฉng sinh dรฃy sแป ngแบซu nhiรชn, vรฌ vแบญy RC4 ฤแบกt ฤฦฐแปฃc mแปฉc ฤแป an toรn cao.
54

3.1 โ Mร DรNG
ยก Hแป mรฃ RC4 (Tแปng quรกt)
ยก Hai giai ฤoแบกn cแปงa RC4:
# Khoi tao day so S va T
for i = 0 to 255 do
     S[i] = i;
     T[i] = K[i mod N];
next i
# Hoan vi day S
j=0
for i = 0 to 255 do
     j = (j + S[i] + T[i]) mod 256;
     Swap(S[i], S[j]);
next j
i, j = 0;
while (true):
     i = (i + 1) mod 256;
     j = (j + S[i]) mod 256;
     Swap(S[i], S[j]);
     t = (S[i] + S[j]) mod 256;
     k = S[t];
end while
Giai ฤoแบกn khแปi tแบกo
Giai ฤoแบกn sinh sแป
55

3.2 โ Mร KHแปI
ยก Mรฃ khแปi an toรn lรฝ tฦฐแปng
ยก Hแบกn chแบฟ cแปงa phรฉp toรกn XOR: Chแป cแบงn biแบฟt mแปt cแบทp khแปi bแบฃn rรต vร bแบฃn mรฃ, ta cรณ
thแป suy ra ฤฦฐแปฃc khรณa vร dรนng khรณa ฤรณ ฤแป giแบฃi cรกc khแปi bแบฃn mรฃ khรกc (known-
plaintext attack)
=> Do ฤรณ, ฤแป chแปng phรก mรฃ trong trฦฐแปng hแปฃp known-plaintext, ta chแป cรณ thแป lรm
cho bแบฃn rรต P vร bแบฃn mรฃ C khรดng cรณ mแปi liรชn hแป toรกn hแปc vแปi nhau.
ยก Nแบฟu ngฦฐแปi phรก mรฃ chแป biแบฟt mแปt sแป cแบทp bแบฃn rรต - bแบฃn mรฃ thรฌ cลฉng khรดng suy ra
ฤฦฐแปฃc cรกc bแบฃn rรต cho cรกc bแบฃn mรฃ cรฒn lแบกi (nghฤฉa lร: muแปn phรก mรฃ thรฌ phแบฃi biแบฟt
ฤฦฐแปฃc tแบฅt cแบฃ cรกc cแบทp bแบฃn rรต vร bแบฃn mรฃ).
ยก Nแบฟu ta chแปn kรญch thฦฐแปc cแปงa khแปi lร 64 bรญt thรฌ sแป dรฒng cแปงa bแบฃng khรณa lร 264 (mแปt
sแป rแบฅt lแปn) nรชn ngฦฐแปi phรก mรฃ khรดng thแป nแบฏm ฤฦฐแปฃc tแบฅt cแบฃ cรกc cแบทp bแบฃn rรต-bแบฃn mรฃ
cแปงa bแบฃng khรณa vร trฦฐแปng hแปฃp nรy ฤฦฐแปฃc gแปi lร mรฃ khแปi an toรn lรฝ tฦฐแปng.
56

3.2 โ Mร KHแปI
ยก Mแบกng SPN (Substitution-Permutation Network)
ยก
ฤแป xแบฅp xแป ฤแป an toรn cแปงa mรฃ khแปi lรฝ tฦฐแปng, ta kแบฟt hแปฃp hai hay nhiแปu mรฃ hรณa ฤฦกn giแบฃn lแบกi vแปi
nhau ฤแป tแบกo thรnh mแปt mรฃ hรณa tแปng (product cipher) vร mรฃ hรณa tแปng nรy an toรn hฦกn nhiแปu
so vแปi cรกc mรฃ hรณa thรnh phแบงn.
ยก
Cรกc mรฃ hรณa ฤฦกn giแบฃn thฦฐแปng lร phรฉp thay thแบฟ (substitution, S-box) vร hoรกn vแป (Permutation,
P-box) nรชn ngฦฐแปi ta gแปi mรฃ hรณa tแปng nรy lร mแบกng SPN (Substitution-Permutation Network).
ยก
Mรด hรฌnh mแปt mแบกng SPN (lร kแบฟt hแปฃp cรกc S-box vร P-box).
57

3.2 โ Mร KHแปI
ยก Mรด hรฌnh mรฃ Feistel:
ยก Mรด hรฌnh mรฃ Feistel lร mแปt tiแบฟp cแบญn khรกc vแปi mแบกng SPN. Mรด hรฌnh nรy do Horst 
Feistel ฤแป xuแบฅt, lร sแปฑ kแบฟt hแปฃp cรกc phรฉp thay thแบฟ vร hoรกn vแป.
ยก Quรก trรฌnh mรฃ hรณa cแปงa Feistel: Bแบฃn rรต P sแบฝ ฤฦฐแปฃc biแบฟn ฤแปi qua mแปt sแป vรฒng ฤแป cho ra 
bแบฃn mรฃ: P โ Kโ Cโ โ Kโ Cโ โ ... โ Kโโโ Cโ
ยก
Trong ฤรณ bแบฃn rรต P vร cรกc bแบฃn mรฃ Cแตข ฤฦฐแปฃc chia thรnh nแปญa trรกi vร nแปญa phแบฃi:
P = (Lโ, Rโ)
Cแตข = (Lแตข, Rแตข) i = 1, 2, ...n
ยก
Quy tแบฏc biแบฟn ฤแปi cรกc nแปญa trรกi phแบฃi nรy qua cรกc vรฒng ฤฦฐแปฃc thแปฑc hiแปn nhฦฐ sau:
Lแตข = Rแตขโโ
Rแตข = Lแตขโโ โ F(Rแตขโโ, Kแตข)
ยก
Kแตข lร mแปt khรณa con cho vรฒng thแปฉ i. Khรณa con nรy ฤฦฐแปฃc sinh ra tแปซ khรณa K ban ฤแบงu theo mแปt thuแบญt toรกn 
sinh khรณa con (key schedule): K โ Kโ โ Kโ โ ... โ Kโ
ยก
F lร mแปt hรm mรฃ hรณa dรนng chung cho tแบฅt cแบฃ cรกc vรฒng. Hรm F ฤรณng vai trรฒ nhฦฐ lร phรฉp thay thแบฟ cรฒn 
viแปc hoรกn ฤแปi cรกc nแปญa trรกi phแบฃi cรณ vai trรฒ hoรกn vแป. Bแบฃn mรฃ C ฤฦฐแปฃc tรญnh tแปซ kแบฟt xuแบฅt cแปงa vรฒng cuแปi 
cรนng:
C = Cโ = (Lโ, Rโ)
58

3.2 โ Mร KHแปI
ยก Mรด hรฌnh mรฃ Feistel:
=> Sฦก ฤแป tรญnh toรกn cแปงa hแป mรฃ Feistel (hรฌnh bรชn):
ยก
Quรก trรฌnh giแบฃi mรฃ cแปงa Feistel:
Ta thแปฑc hiแปn qua cรกc vรฒng theo thแปฉ tแปฑ ngฦฐแปฃc lแบกi nhฦฐ dฦฐแปi 
ฤรขy:
C โ Lโ, Rโ
Rแตขโโ = Lแตข (theo mรฃ hรณa Lแตข = Rแตขโโ)
Lแตขโโ = Rแตข โ F(Rแตขโโ, Kแตข) (theo mรฃ hรณa Rแตข = Lแตขโโ โ F(Rแตขโโ, Kแตข) )
Cuแปi cรนng ฤฦฐแปฃc bแบฃn rรต: P = (Lโ,Rโ).
59

3.2 โ Mร KHแปI
ยก Hแป mรฃ TinyDES
Ta sแบฝ xem xรฉt chi tiแบฟt mรด hรฌnh thu nhแป cแปงa hแป mรฃ 
DES (Data Encryption Standard) lร TinyDES.
ยก
Tรญnh chแบฅt vร cรกc vรฒng Feistel cแปงa hแป mรฃ TinyDES:
ยก
Tรญnh chแบฅt cแปงa hแป mรฃ Tiny DES:
ยก Lร mรฃ thuแปc hแป mรฃ Feistel gแปm 3 vรฒng.
ยก Kรญch thฦฐแปc cแปงa khแปi lร 8 bรญt.
ยก Kรญch thฦฐแปc khรณa lร 8 bรญt.
ยก Mแปi vรฒng cแปงa TinyDES dรนng khรณa con cรณ kรญch 
thฦฐแปc 6 bรญt ฤฦฐแปฃc trรญch ra tแปซ khรณa chรญnh.
ยก
Cรกc vรฒng Feistel cแปงa hแป mรฃ TinyDES:
ยก
Hแป mรฃ TinyDES gแปm 2 phแบงn: Cรกc vรฒng Feistel vร 
thuแบญt toรกn sinh khรณa con.
60

3.2 โ Mร KHแปI
ยก Hแป mรฃ TinyDES
ยก
Cรกc vรฒng cแปงa TinyDES:
ยก
Cแบฅu trรบc 1 vรฒng cแปงa Feistel cแปงa TinyDES
61

3.2 โ Mร KHแปI
ยก Hแป mรฃ TinyDES
ยก
Cรกc vรฒng cแปงa TinyDES:
ยก
Mรด tแบฃ cรกc hรm:
ยก
Expand: gแปi 4 bรญt cแปงa Ri-1 lร b0b1b2b3. Hรm Expand hoรกn vแป vร mแป rแปng 4 bรญt thรnh 6 bรญt cho ra kแบฟt 
quแบฃ: b2b3b1b2b1b0.
Vรญ dแปฅ: R0 = 0110 โ Expand(R0) = 101110
ยก
S-box: Gแปi b0b1b2b3b4b5 lร 6 bรญt ฤแบงu vรo cแปงa S-box, แปฉng vแปi mแปi trฦฐแปng hแปฃp cแปงa 6 bรญt ฤแบงu vรo sแบฝ cรณ 4 
bรญt ฤแบงu ra. Viแปc tรญnh cรกc bรญt ฤแบงu ra dแปฑa trรชn bแบฃng sau:
62

3.2 โ Mร KHแปI
ยก Hแป mรฃ TinyDES
ยก
Cรกc vรฒng cแปงa TinyDES:
ยก
Mรด tแบฃ cรกc hรm:
ยก
Hai bรญt b0b5 xรกc ฤแปnh thแปฉ tแปฑ hรng, bแปn bรญt b1b2b3b4 xรกc ฤแปnh thแปฉ tแปฑ cแปt cแปงa bแบฃng. Tแปซ ฤรณ dแปฑa vรo bแบฃng 
tรญnh ฤฦฐแปฃc 4 bรญt ฤแบงu ra. ฤแป cho ฤฦกn giแบฃn, ta cรณ thแป viแบฟt lแบกi bแบฃng trรชn dฦฐแปi dแบกng sแป thแบญp lแปฅc phรขn.
ยก
Vรญ dแปฅ: X = 101010. Tra bแบฃng ta cรณ S-box(X) = 0110. (Tแปฉc giรก trแป bแบฑng 6 trong sแป thแบญp lแปฅc phรขn)
ยก
P-box: thแปฑc hiแปn hoรกn vแป 4 bรญt ฤแบงu b0b1b2b3 cho ra kแบฟt quแบฃ b2b0b3b1.
63

3.2 โ Mร KHแปI
ยก Hแป mรฃ TinyDES
ยก
Thuแบญt toรกn sinh khoรก con cแปงa TinyDES
ยก
Khรณa K 8 bรญt ban ฤแบงu ฤฦฐแปฃc chia thรnh 2 nแปญa trรกi vร phแบฃi lร KL0 vร KR0 (mแปi nแปญa cรณ kรญch
thฦฐแปc 4 bรญt).
ยก
Tแบกi vรฒng thแปฉ nhแบฅt KL0 vร KR0 ฤฦฐแปฃc dแปch vรฒng trรกi 1 bรญt ฤแป cรณ ฤฦฐแปฃc KL1 vร KR1.
ยก
Tแบกi vรฒng thแปฉ hai KL1 vร KR1 ฤฦฐแปฃc dแปch vรฒng trรกi 2 bรญt ฤแป cรณ ฤฦฐแปฃc KL2 vร KR2.
ยก
Tแบกi vรฒng thแปฉ 3 KL2 vร KR2 ฤฦฐแปฃc dแปch vรฒng trรกi 1 bรญt ฤแป cรณ KL3 vร KR3.
ยก
Cuแปi cรนng khรณa Ki cแปงa mแปi vรฒng ฤฦฐแปฃc tแบกo ra bแบฑng cรกch hoรกn vแป vร nรฉn (compress) 8 bรญt
cแปงa KLi vร KRi(k0k1k2k3k4k5k6k7) thรnh kแบฟt quแบฃ gแปm 6 bรญt: k5k1k3k2k7k0.
ยก
BTVD: Hรฃy mรฃ hรณa bแบฃn rรต P = 01011100 (5C) (แป hแป cฦก sแป 16) vแปi khรณa K = 10011010 ?
64

3.2 โ Mร KHแปI
ยก Hแป mรฃ TinyDES
ยก
BTVD: Hรฃy mรฃ hรณa bแบฃn rรต P = 01011100 (5C) (แป hแป cฦก sแป 16) vแปi khรณa K = 10011010 ?
ยก
Giแบฃi: L0 = 0101, R0 = 1100, KL0 = 1001, KR0 = 1010
ยก
Vรฒng 1:
- L1 = R0 = 1100, Expand(R0) = 001011
- KL1 = KL0 << 1 = 0011, KR1 = KR0 << 1 = 0101
- K1 = Compress(KL1KR1) = 101110
- Expand(R0) โ K1 = 100101
- S-box(100101) = 1000
- F1 = P-box(1000) = 0100
- R1 = L0 โ F1 = 0001
ยก
Vรฒng 2:
- L2 = R1 = 0001, Expand(R1) = 010000
- KL2 = KL1 << 2 = 1100, KR2 = KR1 << 2 = 0101
- K2 = Compress(KL2KR2) = 110011
- Expand(R1) โ K2 = 100011
- S-box(100011) = 1100
- F2 = P-box(1100) = 0101
- R2 = L1 โ F2 = 1001
Vรฒng 3:
- L3 = R2 = 1001, Expand(R2) = 010001
- KL3 = KL2 << 1 = 1001, KR3 = KR2 << 1 = 1010
- K3 = Compress(KL3KR3) = 001001
- Expand(R2) โ K3 = 011000
- S-box(011000) = 0101
- F3 = P-box(0101) = 0011
- R3 = L2 โ F3 = 0010
โข Kแบฟt quแบฃ C = L3R3 = 1001.0010 (hแป thแบญp lแปฅc phรขn: 92)
65

3.2 โ Mร KHแปI
ยก Hแป mรฃ DES (Data Encryption Standard) (tแปng quรกt)
ยก
Tรญnh chแบฅt vร cรกc vรฒng Feistel cแปงa hแป mรฃ DES:
ยก Tรญnh chแบฅt cแปงa hแป mรฃ DES:
ยก Lร mรฃ thuแปc hแป mรฃ Feistel gแปm 16 vรฒng, ngoรi ra DES cรณ thรชm mแปt hoรกn vแป khแปi tแบกo
trฦฐแปc khi vรo vรฒng 1 vร mแปt hoรกn vแป kแบฟt thรบc sau vรฒng 16.
ยก Kรญch thฦฐแปc cแปงa khแปi lร 64 bรญt. Vรญ dแปฅ bแบฃn rรต โmeetmeafterthetogapartyโ (biแปu diแปn
theo mรฃ ASCII) thรฌ mรฃ DES sแบฝ mรฃ hรณa lรm 3 lแบงn (mแปi lแบงn 8 chแปฏ cรกi (64 bรญt) lร:
meetmeaf - tertheto - gaparty).
ยก Kรญch thฦฐแปc khรณa lร 56 bรญt.
ยก Mแปi vรฒng cแปงa DES dรนng khรณa con cรณ kรญch thฦฐแปc 48 bรญt ฤฦฐแปฃc trรญch ra tแปซ khรณa chรญnh.
66

3.2 โ Mร KHแปI
ยก Hแป mรฃ DES (Data Encryption Standard) (tแปng quรกt)
ยก
Tรญnh chแบฅt vร cรกc vรฒng Feistel cแปงa hแป mรฃ DES:
ยก
Cรกc vรฒng Feistel cแปงa hแป mรฃ DES
ยก
Hแป mรฃ DES gแปm 3 phแบงn: 
ยก Hoรกn vแป khแปi tแบกo vร hoรกn vแป kแบฟt thรบc; 
ยก 85 vรฒng Feistel; 
ยก Thuแบญt toรกn sinh khรณa con
67

3.2 โ Mร KHแปI
ยก Hแป mรฃ DES (Data Encryption Standard) (tแปng quรกt)
ยก Hoรกn vแป khแปi tแบกo vร hoรกn vแป kแบฟt thรบc:
ยก
ฤรกnh sแป cรกc bรญt cแปงa khแปi 64 bรญt theo thแปฉ tแปฑ tแปซ trรกi sang phแบฃi lร 0, 1,โฆ, 62, 63 lร: b0 b1 b2 โฆb62 b63
ยก
Hoรกn vแป khแปi tแบกo hoรกn ฤแปi cรกc bรญt theo quy tแบฏc (hรฌnh trรกi):
ยก
Hoรกn vแป kแบฟt thรบc hoรกn ฤแปi cรกc bรญt theo quy tแบฏc (hรฌnh phแบฃi):
68

3.2 โ Mร KHแปI
ยก Hแป mรฃ DES (Data Encryption Standard) (tแปng quรกt)
ยก Cรกc vรฒng cแปงa DES:
ยก
Cแบฅu trรบc 1 vรฒng cแปงa Feistel cแปงa DES:
ยก
Trong DES, hรm F cแปงa Feistel lร:
F(Ri-1, Ki) = P-box(S-boxes(Expand(Ri-1) โ Ki))
trong ฤรณ: hรm Expand vแปซa mแป rแปng vแปซa hoรกn vแป 
Ri-1 tแปซ 32 bรญt lรชn 48 bรญt, hรm S-boxes nรฉn 48 bรญt 
lแบกi cรฒn 32 bรญt, hรm P-box lร mแปt hoรกn vแป 32 bรญt.
69

3.2 โ Mร KHแปI
ยก Hแป mรฃ DES (Data Encryption Standard) (tแปng quรกt)
ยก Cรกc vรฒng cแปงa DES:
ยก
Mรด tแบฃ cรกc hรm:
+ Hรm Expand: ฤรกnh sแป cรกc bรญt cแปงa R i-1 theo thแปฉ tแปฑ tแปซ trรกi sang 
phแบฃi lร 0, 1, 2, โฆ, 31. Hรm Expand thแปฑc hiแปn vแปซa hoรกn vแป vแปซa mแป 
rแปng 32 bรญt thรnh 48 bรญt theo quy tแบฏc (hรฌnh bรชn):
+ Hรm S-boxes: Biแบฟn ฤแปi mแปt sแป 48 bรญt thรnh mแปt sแป 32 bรญt. ฤแป 
giแบฃm kรญch thฦฐแปc cแปงa bแบฃng tra cแปฉu, S-boxes ฤฦฐแปฃc chia thรnh 8 
hรm S-box con (mแปi hรm biแบฟn ฤแปi sแป 6 bรญt thรnh sแป 4 bรญt (hรฌnh 
bรชn dฦฐแปi)):
48 bit
70

3.2 โ Mร KHแปI
ยก Hแป mรฃ DES (Data Encryption Standard) (tแปng quรกt)
ยก Cรกc vรฒng cแปงa DES:
ยก
Mรด tแบฃ cรกc hรm (tiแบฟp):
+ Hรm S-boxes (tiแบฟpโฆ): Hรm S-box ฤแบงu tiรชn, hแปp S1, giแปng S-box cแปงa TinyDES nhฦฐ dฦฐแปi ฤรขy. Cรฒn cรกc 
hแปp S-box cรฒn lแบกi (Xem แป phแบงn Phแปฅ Lแปฅc 1)
+ Hรm P-box: Thแปฑc hiแปn hoรกn vแป 32 bรญt ฤแบงu vรo theo quy tแบฏc:
71

3.2 โ Mร KHแปI
ยก Hแป mรฃ DES (Data Encryption Standard) (tแปng quรกt)
ยก Thuแบญt toรกn sinh khoรก con cแปงa DES:
โข
Khรณa K 64 bรญt ban ฤแบงu ฤฦฐแปฃc rรบt trรญch vร hoรกn vแป thรnh 
mแปt khรณa 56 bรญt (chแป sแปญ dแปฅng 56 bรญt) theo quy tแบฏc (hรฌnh 
bรชn):
โข
Khรณa 56 bรญt nรy ฤฦฐแปฃc chia thรnh 2 nแปญa trรกi phแบฃi KLโ vร KRโ
(mแปi nแปญa cรณ kรญch thฦฐแปc 28 bรญt).
Tแบกi vรฒng thแปฉ i (i = 1, 2, 3,...,16), KLi-1 vร KRi-1 
ฤฦฐแปฃc dแปch 
vรฒng trรกi ri bรญt ฤแป cรณ ฤฦฐแปฃc KLi vร KRi, 
vแปi ri ฤฦฐแปฃc ฤแปnh nghฤฉa: 
ri= { 1 nแบฟu i โ
{1,2,9,16}; 2 vแปi nhแปฏng i khรกc }
โข
Cuแปi cรนng, khรณa Ki cแปงa mแปi vรฒng ฤฦฐแปฃc tแบกo ra bแบฑng cรกch 
hoรกn vแป vร nรฉn 56 bรญt cแปงa KLi vร KRi thรnh 48 bรญt theo quy 
tแบฏc:
72

3.2 โ Mร KHแปI
ยก Hแป mรฃ DES (Data Encryption Standard) (tแปng quรกt)
ยก Phแปฅ lแปฅc 1: Chi tiแบฟt cรกc S-box cแปงa mรฃ hoรก DES
73

3.2 โ Mร KHแปI
ยก Hแป mรฃ DES (Data Encryption Standard) (tแปng quรกt)
ยก Phแปฅ lแปฅc 1: Chi tiแบฟt cรกc S-box cแปงa mรฃ hoรก DES
74

3.2 โ Mร KHแปI
ยก Mแปt sแป phฦฐฦกng phรกp mรฃ khแปi khรกc
ยก
Double DES (DDES):
ยก
ฤแบทc ฤiแปm: Dรนng DES 2 lแบงn vแปi 2 khรณa Kโ, Kโ khรกc nhau:
ยก
Mรฃ hรณa: C = DESK2[DESK1(M)]
ยก
Giแบฃi mรฃ: M = DES-1K1[DES-1K2(C)] (vแปi: M lร bแบฃn rรต, DES lร hรm mรฃ, DES-1 lร hรm giแบฃi mรฃ)
ยก
ฤแป (hรฌnh bรชn):
75

3.2 โ Mร KHแปI
ยก Mแปt sแป phฦฐฦกng phรกp mรฃ khแปi khรกc
ยก
Triple DES (TDES):
ยก
ฤแบทc ฤiแปm: Dรนng DES 3 lแบงn vแปi 2 khรณa Kโ, Kโ khรกc nhau:
ยก
Mรฃ hรณa: 
C = DESK1[DES-1K2[DESK1(M)]]
ยก
Giแบฃi mรฃ: 
M = DES-1K1[DESK2[DES-1K1(C)]]
ยก
Sฦก ฤแป (hรฌnh bรชn):
76

3.2 โ Mร KHแปI
ยก Mแปt sแป phฦฐฦกng phรกp mรฃ khแปi khรกc
ยก
Chuแบฉn mรฃ hรณa nรขng cao (AES) (Advanced Encryption Standard):
ยก
ฤแบทc ฤiแปm cแปงa AES: Lร mรฃ khแปi ฤแปi xแปฉng khoรก riรชng, kรญch thฦฐแปc khแปi dแปฏ liแปu 128 bit vร ฤแป dรi khoรก lร tรนy biแบฟn: 
128, 192 hoแบทc 256 bit.
ยก
Chuแบฉn mรฃ nรขng cao AES - Rijndael: Rijndael ฤฦฐแปฃc chแปn lร chuแบฉn mรฃ nรขng cao, ฤฦฐแปฃc thiแบฟt kแบฟ bแปi Rijmen โ
Daemen (Bแป), cรณ cรกc ฤแบทc trฦฐng:
+ Cรณ 128/192/256 bit khoรก vร 128 bit khแปi dแปฏ liแปu.
+ Lแบทp (khรกc ฤรดi chรบt so vแปi Feistel) lร: Chia dแปฏ liแปu thรnh 4 nhรณm (mแปi nhรณm 4 byte), thao tรกc trรชn cแบฃ khแปi 
mแปi vรฒng.
+ Xแปญ lรฝ khแปi dแปฏ liแปu 128 bit nhฦฐ 4 nhรณm cแปงa 4 byte: 128 = 4*4*8 bit (mแปi nhรณm nแบฑm trรชn 1 hรng). Ma trแบญn 4 
hรng, 4 cแปt vแปi mแปi phแบงn tแปญ lร 1 byte coi nhฦฐ trแบกng thรกi ฤฦฐแปฃc xแปญ lรฝ qua cรกc vรฒng mรฃ hoรก vร giแบฃi mรฃ.
+ Khoรก mแป rแปng thรnh mแบฃng gแปm 44 tแปซ 32 bit.
+ Cรณ tรนy chแปn 9/11/13 vรฒng, trong ฤรณ mแปi vรฒng gแปm: Phรฉp thแบฟ byte (dรนng 1 hแปp S-box cho 1 byte), dแปch hรng 
(hoรกn vแป byte giแปฏa nhรณm/cแปt), trแปn cแปt (sแปญ dแปฅng nhรขn ma trแบญn cแปงa cรกc cแปt), cแปng khoรก vรฒng (XOR trแบกng thรกi 
dแปฏ liแปu vแปi khoรก vรฒng), mแปi phรฉp toรกn thแปฑc hiแปn vแปi phรฉp XOR vร bแบฃng tra cแปฉu nรชn rแบฅt nhanh vร hiแปu quแบฃ.
ยก
Cรกc mรด hรฌnh แปฉng dแปฅng mรฃ khแปi *: Electronic Codebook โ ECB, Counter โ CTR, Cipher Block Chaining โ CBC, 
Output Feedback โ OFB, Cipher Feedback โ CFB 95 (Xem thรชm trong giรกo trรฌnh vร tรi liแปu tham khแบฃo).
77

4 โ TรNH CHแปจNG THแปฐC Vร KHรNG Tแปช CHแปI
ยก Tรญnh chแปฉng thแปฑc (Authentication)
ยก
Mรฃ hรณa ฤแปi xแปฉng cรณ thแป chแปng lแบกi cรกc hรฌnh thแปฉc tแบฅn cรดng:
ยก
Mแบกo danh: Kแบป thแปฉ ba mแบกo danh, nghฤฉa lร: A gแปญi thรดng ฤiแปp (bแบฃn rรต) cho B mร B lแบกi nghฤฉ
rแบฑng thรดng ฤiแปp ฤรณ lร do C gแปญi.
ยก
Sแปญa ฤแปi nแปi dung thรดng ฤiแปp: Nแบฟu A chแบทn ฤฦฐแปฃc bแบฃn mรฃ cแปงa B vร sแปญa ฤแปi thรดng ฤiแปp thรฌ xรกc
suแบฅt ฤแป bแบฃn rรต lร vฤn bแบฃn cรณ nghฤฉa cลฉng rแบฅt nhแป vร C biแบฟt ฤฦฐแปฃc bแบฃn rรต ฤรฃ bแป sแปญa ฤแปi.
ยก
Phรกt lแบกi thรดng ฤiแปp (replay attack): A gแปญi bแบฃn mรฃ cho B, B nhแบญn ฤฦฐแปฃc vร giแบฃi mรฃ ฤแป cรณ bแบฃn
rรต. Tuy nhiรชn, C chแบทn ฤฦฐแปฃc bแบฃn mรฃ vร sau ฤรณ mแบกo danh A gแปญi bแบฃn mรฃ cho B thรชm mแปt lแบงn
nแปฏa. B giแบฃi mรฃ vร cลฉng cรณ ฤฦฐแปฃc bแบฃn rรต => Nhฦฐ vแบญy, B nhแบญn ฤฦฐแปฃc cรนng mแปt bแบฃn rรต 2 lแบงn.
Tแบกi lแบงn thแปฉ 2, B khรดng cรณ cฦก sแป xรกc ฤแปnh lร A muแปn gแปญi lแบกi hay lร do A gแปญi.
=> Do ฤรณ, ฤแป ฤแบฃm bแบฃo tรญnh chแปฉng thแปฑc, dรนng mรฃ chแปฉng thแปฑc thรดng ฤiแปp (MAC).
78

4 โ TรNH CHแปจNG THแปฐC Vร KHรNG Tแปช CHแปI
ยก Tรญnh khรดng tแปซ chแปi(Non-repudiation)
ยก
Mรฃ hรณa ฤแปi xแปฉng cรณ thแป chแปng lแบกi cรกc hรฌnh thแปฉc tแบฅn cรดng nhฦฐng mรฃ hรณa ฤแปi xแปฉng lแบกi khรดng
thแปฑc hiแปn ฤฦฐแปฃc tรญnh khรดng tแปซ chแปi do tรญnh bรญ mแบญt cแปงa khรณa (vรฌ khรณa K bรญ mแบญt cรณ hai ngฦฐแปi biแบฟt
nรชn nแบฟu K bแป tiแบฟt lแป thรฌ khรดng cรณ cฦก sแป ฤแป quy trรกch nhiแปm cho A hay B trong 2 ngฦฐแปi lรm lแป
khรณa. Do ฤรณ, A cรณ thแป tแปซ chแปi lร ฤรฃ gแปญi thรดng ฤiแปp.
ยก
=> ฤแป khแบฏc phแปฅc: Nghiรชn cแปฉu vร phรกt triแปn cรกc hแป mรฃ hรณa khรณa cรดng khai
79

5 โ TRAO ฤแปI KHOร Bร MแบฌT BแบฐNG TRUNG TรM PHรN PHแปI 
KHOร
ยก Vแบฅn ฤแป
ยก
Giแบฃ sแปญ cรณ N ngฦฐแปi sแปญ dแปฅng, trao ฤแปi dแปฏ liแปu bแบฑng mรฃ hรณa ฤแปi xแปฉng, mแปi cแบทp ngฦฐแปi sแปญ dแปฅng
cแบงn cรณ mแปt khรณa bรญ mแบญt riรชng, dแบซn ฤแบฟn cแบงn cรณ N(N-1)/2 khรณa bรญ mแบญt. Viแปc thiแบฟt lแบญp cรกc khรณa
bรญ mแบญt nรy sแบฝ gรขy ra khรณ khฤn cho cรกc ngฦฐแปi sแปญ dแปฅng vรฌ mแปi ngฦฐแปi cแบงn thiแบฟt lแบญp N-1 khรณa =>
ฤแป khแบฏc phแปฅc, sแปญ dแปฅng phฦฐฦกng phรกp trao ฤแปi khรณa bแบฑng trung tรขm phรขn phแปi khรณa (Key
Distribution Center โ KDC).
ยก
=> Trong mรด hรฌnh sแปญ dแปฅng KDC, mแปi ngฦฐแปi sแปญ dแปฅng chแป cแบงn cรณ mแปt khรณa bรญ mแบญt vแปi KDC, cรฒn
khรณa dรนng ฤแป trao ฤแปi dแปฏ liแปu giแปฏa cรกc ngฦฐแปi sแปญ dแปฅng sแบฝ do KDC cung cแบฅp.
80

5 โ TRAO ฤแปI KHOร Bร MแบฌT BแบฐNG TRUNG TรM PHรN PHแปI 
KHOร
ยก
Quรก trรฌnh thiแบฟt lแบญp khรณa chung KAB: Giแบฃ sแปญ A cรณ khรณa bรญ mแบญt KA
vแปi KDC vร B cรณ khรณa bรญ mแบญt KB vแปi KDC. Bรขy giแป, A muแปn trao ฤแปi
dแปฏ liแปu vแปi B, gแปm cรกc bฦฐแปc:
ยก
B1: A gแปญi yรชu cแบงu muแปn trao ฤแปi dแปฏ liแปu vแปi B cho KDC.
ยก
B2: KDC tแบกo mแปt khรณa bรญ mแบญt KAB vร mรฃ hรณa thรnh hai bแบฃn mรฃ.
Mแปt bแบฃn mรฃ ฤฦฐแปฃc mรฃ hรณa bแบฑng khรณa bรญ mแบญt cแปงa A lร E(KAB, KA) vร 
1 bแบฃn mรฃ ฤฦฐแปฃc mรฃ hรณa bแบฑng khรณa bรญ mแบญt cแปงa B lร E(KAB, KB).
ยก
B3: A giแบฃi mรฃ E(KAB, KA) ฤแป cรณ KAB.
ยก
B4: KDC gแปญi E(KAB, KB) cho B, B giแบฃi mรฃ ฤแป cรณ ฤฦฐแปฃc KAB.
ยก
B5: A vร B trao ฤแปi dแปฏ liแปu qua khรณa bรญ mแบญt KAB.
=> Nhฦฐ vแบญy, khรณa KAB chแป cรณ KDC, A vร B biแบฟt. Trรกch nhiแปm cแปงa 
KDC lร giแปฏ bรญ mแบญt khรณa nรy. A vร B dรนng khรณa KAB ฤแป mรฃ hรณa dแปฏ liแปu. 
Khi kแบฟt thรบc quรก trรฌnh thรฌ khรณa KAB bแป hแปงy.
81

TรM TแบฎT NแปI DUNG CHฦฏฦNG 2
ยก Trao ฤแปi/thแบฃo luแบญn nhรณm
ยก Bรi tแบญp/Thแปฑc hรnh
ยก Tรณm tแบฏt nแปi dung
ยก Cรขu hแปi vร bรi tแบญp รดn tแบญp
82
